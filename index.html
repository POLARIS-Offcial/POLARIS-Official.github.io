<!DOCTYPE html>
<html lang="en">
    <script>
        MathJax = {
          tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
          }
        };
      </script>
      <script
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
        async
      ></script>

      <script>
        MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] } };
      </script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POLARIS</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="images/icon.png">
    <link rel="apple-touch-icon" href="images/icon.png">
    <link rel="shortcut icon" href="images/icon.png" type="image/png">
    <style>



/* Citation部分样式 */
#citation {
    margin: 3rem 0;
    padding: 2.5rem 2rem;
}

#citation .title {
    font-size: 2rem;
    margin-bottom: 1.5rem;
    color: var(--primary-color); /* 使用主题蓝色 */
    font-weight: 700;
    text-align: left; /* 与Abstract标题对齐 */
    padding-bottom: 0.5rem;
}

.citation-container {
    position: relative;
    background: var(--bg-card);
    border: 1px solid var(--border-light);
    border-radius: 8px;
    overflow: hidden;
}



#citation pre {
    background: transparent;
    border: none;
    padding: 2rem;
    padding-right: 120px; /* 为按钮留出空间 */
    margin: 0;
    overflow-x: auto;
}

#citation code {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    font-size: 1.1rem;
    line-height: 1.5;
    color: var(--text-primary);
    background: none;
    white-space: pre;
}

.copy-button {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background: var(--primary-color);
    color: white;
    border: none;
    border-radius: 6px;
    padding: 0.6rem 1rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.9rem;
    font-weight: 500;
    transition: all 0.3s ease;
}

.copy-button:hover {
    background: var(--primary-dark);
    transform: translateY(-1px);
    box-shadow: var(--shadow-medium);
}

.copy-button.copied {
    background: #10b981;
}

.copy-button.copied .copy-text {
    display: none;
}

.copy-button.copied::after {
    content: "Copied!";
}

.copy-icon {
    width: 16px;
    height: 16px;
    fill: currentColor;
}

/* 响应式调整 */
@media (max-width: 768px) {
    #citation {
        padding: 2rem 1rem;
    }
    
    #citation .title {
        font-size: 1.8rem;
    }
    
    #citation pre {
        padding: 1.5rem;
        padding-right: 100px;
    }
    
    #citation code {
        font-size: 1rem;
    }
    
    .copy-button {
        top: 0.8rem;
        right: 0.8rem;
        padding: 0.5rem 0.8rem;
        font-size: 0.85rem;
    }
}

@media (max-width: 480px) {
    #citation code {
        font-size: 0.95rem;
    }
    
    #citation pre {
        padding: 1.2rem;
        padding-right: 90px;
    }
    
    .copy-button {
        position: relative;
        top: auto;
        right: auto;
        margin: 0 1.2rem 1.2rem;
        width: calc(100% - 2.4rem);
        justify-content: center;
    }
    
    #citation pre {
        padding-right: 1.2rem;
    }
}
/* Method部分样式 */
.method {
    margin: 3rem 0;
    padding: 2.5rem 2rem; /* 增加左右内边距，与abstract一致 */
}

.method-content {
    display: flex;
    flex-direction: column;
    gap: 2.5rem;
    margin-top: 1.5rem;
}

/* 图片行布局 */
.method-figures-row {
    display: grid;
    grid-template-columns: 1fr 1fr; /* 现在两个图大小相同 */
    gap: 2rem; /* 保持适当间距 */
    align-items: stretch;
}

.method-figure-wrapper {
    display: flex;
    flex-direction: column;
}

.method-figure {
    text-align: center;
    background: var(--bg-card);
    border-radius: 12px;
    padding: 1rem; /* 进一步减少内边距，让图片更大 */
    box-shadow: var(--shadow-soft);
    border: 1px solid var(--border-light);
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.method-image {
    max-width: 100%;
    height: auto;
    border-radius: 8px;
    transition: transform 0.3s ease;
    cursor: pointer;
    display: block;
    margin: 0 auto;
}

.method-image:hover {
    transform: scale(1.02);
}

/* 两个图片样式一致，都更大 */
.vans-image,
.grpo-image {
    width: 100%;
    height: 380px; /* 增加高度，让图片更大 */
    object-fit: contain;
}

.figure-caption {
    margin-top: 1rem;
    color: var(--text-secondary);
    font-size: 0.95rem;
    font-weight: 500;
    line-height: 1.4;
}

.method-description {
    line-height: 1.6;
    max-width: 100%;
    padding: 0 1rem; /* 增加文字内边距 */
}

.method-highlights {
    margin-top: 1.5rem;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    padding: 0 0.5rem; /* 亮点部分也增加内边距 */
}

.highlight-item {
    background: var(--bg-secondary);
    padding: 1.5rem;
    border-radius: 10px;
    border-left: 4px solid var(--primary-color);
    transition: all 0.3s ease;
}

.highlight-item:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-medium);
}

.highlight-item h4 {
    color: var(--text-primary);
    margin: 0 0 0.8rem 0;
    font-size: 1.1rem;
    font-weight: 600;
}

.highlight-item p {
    color: var(--text-secondary);
    margin: 0;
    font-size: 0.95rem;
    line-height: 1.5;
}

/* 响应式设计 */
@media (max-width: 1200px) {
    .method-figures-row {
        gap: 1.5rem;
    }
    
    .vans-image,
    .grpo-image {
        height: 350px;
    }
}

@media (max-width: 992px) {
    .method {
        padding: 2.5rem 1.5rem; /* 中等屏幕调整内边距 */
    }
    
    .method-figures-row {
        grid-template-columns: 1fr;
        gap: 1.5rem;
    }
    
    .method-highlights {
        grid-template-columns: 1fr;
        gap: 1.2rem;
    }
    
    .vans-image,
    .grpo-image {
        height: 320px;
    }
}

@media (max-width: 768px) {
    .method {
        margin: 2rem 0;
        padding: 2rem 1rem; /* 移动端调整内边距 */
    }
    
    .method-content {
        gap: 2rem;
    }
    
    .method-figure {
        padding: 0.8rem;
    }
    
    .vans-image,
    .grpo-image {
        height: 280px;
    }
    
    .highlight-item {
        padding: 1.2rem;
    }
    
    .method-figures-row {
        gap: 1.2rem;
    }
}

@media (max-width: 480px) {
    .method {
        padding: 1.5rem 0.8rem;
    }
    
    .method-figure {
        padding: 0.6rem;
    }
    
    .vans-image,
    .grpo-image {
        height: 220px;
    }
    
    .highlight-item {
        padding: 1rem;
    }
    
    .highlight-item h4 {
        font-size: 1rem;
    }
    
    .figure-caption {
        font-size: 0.9rem;
    }
    
    .method-description {
        padding: 0 0.5rem;
    }
}
.method-challenge,
.method-solution {
    margin-bottom: 2rem;
}

.method-challenge h3,
.method-solution h3 {
    color: var(--text-primary);
    margin-bottom: 1rem;
    font-size: 1.3rem;
    font-weight: 600;
    border-bottom: 2px solid var(--primary-color);
    padding-bottom: 0.5rem;
}

.method-challenge p,
.method-solution p {
    margin-bottom: 1rem;
    line-height: 1.6;
}

.method-conclusion {
    font-weight: 500;
    color: var(--text-primary);
    background: var(--bg-secondary);
    padding: 1rem;
    border-radius: 8px;
    border-left: 4px solid var(--primary-color);
    margin-top: 1.5rem;
}

.figure-caption {
    margin-top: 1rem;
    color: var(--text-secondary);
    font-size: 0.9rem;
    line-height: 1.4;
    text-align: center;
}






        .teaser-image {
            border: none !important;
            outline: none !important;
        }
        /* 作者链接样式 */
        .author-link {
            text-decoration: none;
            color: inherit;
            transition: all 0.3s ease;
        }

        .author-link span {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .author-link:hover span {
            color: var(--primary-color);
            background: rgba(74, 144, 226, 0.1);
            transform: translateY(-1px);
        }


        .author-list-header {
            font-size: 1.4rem; /* 从原来的大约1.1rem增大 */
            font-weight: 600;
            margin: 1rem 0 0.5rem 0;
        }

        /* 增大单位字体 */
        .affiliations-header {
            font-size: 1.1rem; /* 从原来的大约0.9rem增大 */
            margin-bottom: 1.5rem;
            color: var(--text-secondary);
        }

        /* 为作者名字添加可点击样式 */
        .author-list-header span {
            cursor: pointer;
            transition: color 0.3s ease;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .author-list-header span:hover {
            color: var(--primary-color);
            background: rgba(74, 144, 226, 0.1);
        }
        .i2v-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .i2v-card {
            background: var(--bg-card);
            border: 2px solid var(--border-light);
            border-radius: 10px;
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .i2v-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
            border-color: var(--primary-color);
        }

        .i2v-card.active {
            border-color: var(--primary-color);
            background: var(--header-accent-light);
        }

        .i2v-card .i2v-text {
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
            font-size: 1.05rem;
        }

        .expanded-i2v {
            background: var(--bg-card);
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-medium);
        }

        .i2v-content {
            display: flex;
            gap: 1.5rem;
            align-items: flex-start;
            margin-bottom: 1.2rem;
        }

        .i2v-image-container {
            flex: 1;
            min-width: 200px;
            max-width: 300px;
            border-radius: 8px;
            overflow: hidden;
            background: #f8fafc;
            border: 1px solid var(--border-light);
            cursor: pointer;
            transition: transform 0.3s ease;
            aspect-ratio: 1 / 1;
        }

        .i2v-image-container:hover {
            transform: scale(1.02);
        }

        .i2v-image {
            width: 100%;
            height: 100%;
            display: block;
            object-fit: cover;
        }

        .i2v-question {
            flex: 2;
            padding: 1rem;
            background: var(--bg-secondary);
            border-radius: 6px;
            border: 1px solid var(--border-light);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .i2v-question h4 {
            color: var(--text-primary);
            margin: 0 0 0.5rem 0;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .i2v-question p {
            color: var(--text-secondary);
            line-height: 1.4;
            margin: 0;
            font-size: 0.95rem;
        }

        .i2v-answers-section {
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border-light);
        }

        .i2v-answers-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.2rem;
            margin-top: 1.2rem;
        }

        .i2v-answer-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 10px;
            padding: 1.2rem;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .i2v-answer-card:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-soft);
        }

        .i2v-method-name {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.3rem;
            text-align: center;
            font-size: 1rem;
        }

        .i2v-video-container {
            width: 100%;
            position: relative;
            border-radius: 6px;
            overflow: hidden;
            background: #000;
            aspect-ratio: 1 / 1;
            cursor: pointer;
        }

        .i2v-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: transform 0.3s ease;
        }

        .i2v-video-container:hover .i2v-video {
            transform: scale(1.02);
        }

        .modal-image-square {
            width: 100%;
            max-height: 80vh;
            border-radius: 12px;
            object-fit: contain;
            aspect-ratio: 1 / 1;
        }

        @media (max-width: 1400px) {
            .i2v-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .i2v-answers-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 992px) {
            .i2v-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .i2v-content {
                flex-direction: column;
            }
            
            .i2v-image-container {
                min-width: 100%;
            }
            
            .i2v-answers-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .i2v-grid {
                grid-template-columns: 1fr;
            }
        }

        .generalization-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .generalization-card {
            background: var(--bg-card);
            border: 2px solid var(--border-light);
            border-radius: 10px;
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .generalization-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
            border-color: var(--primary-color);
        }

        .generalization-card.active {
            border-color: var(--primary-color);
            background: var(--header-accent-light);
        }

        .generalization-card .generalization-text {
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
            font-size: 1.05rem;
        }

        .expanded-generalization {
            background: var(--bg-card);
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-medium);
        }

        .generalization-content {
            display: flex;
            gap: 1.5rem;
            align-items: flex-start;
            margin-bottom: 1.2rem;
        }

        .generalization-input {
            flex: 1;
            min-width: 300px;
            aspect-ratio: 16 / 9;
            cursor: pointer;
        }

        .generalization-input video {
            width: 100%;
            height: 100%;
            border-radius: 8px;
            object-fit: cover;
            background: #000;
            display: block;
            transition: transform 0.3s ease;
        }

        .generalization-input:hover video {
            transform: scale(1.02);
        }

        .generalization-questions {
            flex: 2;
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.8rem;
        }

        .question-item {
            padding: 0.8rem;
            background: var(--bg-secondary);
            border-radius: 6px;
            border: 1px solid var(--border-light);
            min-height: 60px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .question-item h4 {
            color: var(--text-primary);
            margin: 0 0 0.3rem 0;
            font-size: 1rem;
            font-weight: 600;
        }

        .question-item p {
            color: var(--text-secondary);
            line-height: 1.3;
            margin: 0;
            font-size: 0.9rem;
        }

        .generalization-answers-section {
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border-light);
        }

        .generalization-answers-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.2rem;
            margin-top: 1.2rem;
        }

        .generalization-answer-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 10px;
            padding: 1.2rem;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .generalization-answer-card:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-soft);
        }

        .generalization-method-name {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.3rem;
            text-align: center;
            font-size: 1rem;
        }

        @media (max-width: 1400px) {
            .generalization-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .generalization-answers-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 992px) {
            .generalization-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .generalization-content {
                flex-direction: column;
            }
            
            .generalization-input {
                min-width: 100%;
            }
            
            .generalization-answers-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .generalization-grid {
                grid-template-columns: 1fr;
            }
            
            .question-item {
                padding: 0.6rem;
                min-height: 50px;
            }
        }

        .editing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .editing-card {
            cursor: pointer;
            user-select: none;
        }

        .editing-card.active {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-medium);
        }

        #editingPlayer .expanded-video,
        .downstream-video-wrapper {
            max-width: min(90vw, 840px);
            width: 100%;
            margin: 0 auto;
        }

        #editingPlayer video,
        .downstream-video-wrapper video {
            border-radius: 12px;
            width: 100%;
            height: auto;
        }

        .question-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .question-card {
            background: var(--bg-card);
            border: 2px solid var(--border-light);
            border-radius: 10px;
            padding: 0.8rem 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .question-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
            border-color: var(--primary-color);
        }

        .question-card.active {
            border-color: var(--primary-color);
            background: var(--header-accent-light);
        }

        .question-card .question-text {
            font-weight: 600;
            color: var(--text-primary);
            margin: 0;
            font-size: 1.05rem;
        }

        .answer-section {
            margin: 1.5rem 0;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border-radius: 12px;
            border: 1px solid var(--border-light);
        }

        .answers-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.2rem;
            margin-top: 1.2rem;
        }

        .answer-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 10px;
            padding: 1.2rem;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .answer-card:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-soft);
        }

        .answer-card.expanded {
            border-color: var(--primary-color);
            background: var(--header-accent-light);
        }

        .answer-video-container {
            width: 100%;
            position: relative;
            border-radius: 6px;
            overflow: hidden;
            background: #000;
            aspect-ratio: 16 / 9;
            cursor: pointer;
        }

        .answer-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: transform 0.3s ease;
        }

        .answer-video-container:hover .answer-video {
            transform: scale(1.02);
        }

        .answer-text-container {
            position: relative;
            min-height: 1.8rem;
            cursor: pointer;
        }

        .answer-text-preview {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.3;
            margin: 0;
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .answer-text-full {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
            margin: 0;
            display: none;
        }

        .answer-card.expanded .answer-text-preview {
            display: none;
        }

        .answer-card.expanded .answer-text-full {
            display: block;
        }

        .expand-text-btn {
            background: none;
            border: none;
            color: var(--primary-color);
            cursor: pointer;
            font-size: 0.8rem;
            margin-top: 0.3rem;
            padding: 0;
            text-decoration: underline;
            font-weight: 500;
        }

        .method-name {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.3rem;
            text-align: center;
            font-size: 1rem;
        }

        .expanded-question {
            background: var(--bg-card);
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            box-shadow: var(--shadow-medium);
        }

        .expanded-content {
            display: flex;
            gap: 1.5rem;
            align-items: flex-start;
            margin-bottom: 1.2rem;
        }

        .expanded-video {
            flex: 1;
            min-width: 280px;
            aspect-ratio: 16 / 9;
            cursor: pointer;
        }

        .expanded-video video {
            width: 100%;
            height: 100%;
            border-radius: 8px;
            object-fit: cover;
            background: #000;
            display: block;
            transition: transform 0.3s ease;
        }

        .expanded-video:hover video {
            transform: scale(1.02);
        }

        .expanded-question-text {
            flex: 2;
            padding: 0.8rem;
            background: var(--bg-secondary);
            border-radius: 6px;
            border: 1px solid var(--border-light);
        }

        .expanded-question-text h4 {
            color: var(--text-primary);
            margin: 0 0 0.5rem 0;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .expanded-question-text p {
            color: var(--text-secondary);
            line-height: 1.4;
            margin: 0;
            font-size: 1rem;
        }

        .section-title {
            text-align: center;
            margin-bottom: 1.5rem;
        }
        
        .section-title h2 {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .section-title .subtitle {
            font-size: 1rem;
            color: var(--text-secondary);
        }

        .hidden {
            display: none;
        }

        .fade-in {
            animation: fadeIn 0.4s ease-in;
        }

        .video-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .video-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            position: relative;
            width: 1200px;
            max-width: 95%;
            max-height: 95%;
        }

        .modal-video {
            width: 100%;
            height: auto;
            aspect-ratio: 16 / 9;
            border-radius: 12px;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.8);
        }

        .modal-close {
            position: absolute;
            top: -45px;
            right: 0;
            background: none;
            border: none;
            color: white;
            font-size: 2.2rem;
            cursor: pointer;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s ease;
            z-index: 1001;
        }

        .modal-close:hover {
            color: var(--primary-color);
        }

        .modal-method-name {
            position: absolute;
            top: -50px;
            left: 0;
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
            background: rgba(0, 0, 0, 0.8);
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            border-left: 3px solid var(--primary-color);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .page-content-wrapper {
            max-width: 1800px;
        }

        .container {
            max-width: 1800px;
        }

        .video-fix {
            line-height: 0;
        }

        @media (max-width: 1600px) {
            .question-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        @media (max-width: 1400px) {
            .question-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .answers-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .modal-content {
                width: 1000px;
            }
        }

        @media (max-width: 1200px) {
            .question-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .modal-content {
                width: 900px;
            }
        }

        @media (max-width: 992px) {
            .question-grid {
                grid-template-columns: 1fr;
            }
            
            .answers-grid {
                grid-template-columns: 1fr;
            }
            
            .expanded-content {
                flex-direction: column;
            }
            
            .expanded-video {
                min-width: 100%;
            }

            .modal-content {
                width: 95%;
            }

            .modal-video {
                max-height: 80vh;
            }
        }

        @media (max-width: 768px) {
            .question-grid {
                gap: 0.8rem;
            }
            
            .answers-grid {
                gap: 0.8rem;
            }
            
            .expanded-question {
                padding: 1.2rem;
            }
            
            .question-card {
                padding: 0.6rem 0.8rem;
                min-height: 45px;
            }
            
            .question-card .question-text {
                font-size: 1rem;
            }

            .modal-video {
                max-height: 70vh;
            }

            .modal-close {
                font-size: 1.8rem;
                top: -35px;
            }

            .modal-method-name {
                font-size: 1rem;
                top: -40px;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="geometric-decoration"></div>
        <div class="container">
            <h1>POLARIS: Projection-Orthogonal Least Squares for Robust and Adaptive
                Inversion in Diffusion Models</h1>
            <div class="author-list-header">
                <a href="https://chatonz.github.io/" target="_blank" class="author-link">
                    <span>Wenshuo Chen<sup>1*</sup>, </span>
                </a>
                <a href="https://scholar.google.com/citations?user=pjjFN2cAAAAJ&hl=zh-CN" target="_blank" class="author-link">
                    <span>Haosen Li<sup>1*</sup>, </span>
                </a>
                <a href="https://dblp.org/pid/397/1364.html" target="_blank" class="author-link">
                    <span>Shaofeng Liang<sup>1*</sup>, </span>
                </a>
                <a href="https://leiwangr.github.io/" target="_blank" class="author-link">
                    <span>Lei Wang<sup>2,3</sup></span>
                </a>
                <a href="https://scholar.google.com/citations?user=xKAJ2nkAAAAJ&hl=zh-CN" target="_blank" class="author-link">
                    <span>Haozhe Jia<sup>1</sup></span>
                </a>
                <a href="https://yuankaishen2001.github.io/Kkkkkkyle/" target="_blank" class="author-link">
                    <span>Kaishen Yuan<sup>1</sup></span>
                </a>
                <a href="https://scholar.google.com/citations?user=INre9KUAAAAJ&hl=zh-CN" target="_blank" class="author-link">
                    <span>Jiemin Wu<sup>1</sup></span>
                </a>
                <a href="https://scholar.google.com/citations?user=SwhX3JkAAAAJ&hl=zh-CN" target="_blank" class="author-link">
                    <span>Bowen Tian<sup>1</sup></span>
                </a>
                <a href="https://yutaoyue.github.io/" target="_blank" class="author-link">
                    <span>Yutao Yue<sup>1</sup></span>
                </a>
            </div>
            <div class="affiliations-header">
                <span><sup>1</sup>The Hong Kong University of Science and Technology (Guangzhou)</span><br>
                <span><sup>2</sup>Griffith University</span><br>
                <span><sup>3</sup>Data61/CSIRO</span><br>
                <span>*Equal Contribution</span>
            </div>
            <div class="external-links">
                <a href="https://github.com/Chatonz/POLARIS" class="external-link" target="_blank">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1.99 6H7V7h10.01v2zm0 4H7v-2h10.01v2zm-3 4H7v-2h7.01v2z"/>
                    </svg>
                    <span>Paper</span>
                </a>
                <a href="https://github.com/Chatonz/POLARIS" class="external-link" target="_blank">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>
                    </svg>
                    <span>Code</span>
                </a>
                <a href="https://github.com/Chatonz/POLARIS" class="external-link" target="_blank">
                    <svg class="icon" viewBox="0 0 24 24">
                        <path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18-.21 0-.41-.06-.57-.18l-7.9-4.44A.991.991 0 013 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18.21 0 .41.06.57.18l7.9 4.44c.32.17.53.5.53.88v9M12 4.15L6.04 7.5 12 10.85l5.96-3.35L12 4.15z"/>
                    </svg>
                    <span>Model</span>
                </a>
            </div>
        </div>
    </header>

    <div class="page-content-wrapper">
        <main class="main-content-area">
            <div class="container">
                
                <!-- <section id="abstract" class="abstract section">
                    <h2>Abstract</h2>
                    <div class="teaser-image-container" style="text-align: center; ">
                        <video class="teaser-image" autoplay muted loop playsinline style="transform: scale(1.2); display: inline-block; max-width: 100%; height: auto;">
                            <source src="videos/teaser.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    <p>The Inversion-Denoising Paradigm, which is based on diffusion models, excels in diverse image editing and restoration tasks.
                         We revisit its mechanism and reveal a critical, overlooked factor in reconstruction degradation: </b>the approximate noise error</b>
                . This error stems from approximating the noise at step $t$ with the prediction at step $t\!-\!1$, resulting in severe error accumulation throughout the inversion process. We introduce Projection-Orthogonal Least Squares for Robust and Adaptive Inversion (POLARIS), which reformulates inversion from an error-compensation problem into an error-origin problem. Rather than optimizing embeddings or latent codes to offset accumulated drift, POLARIS treats the guidance scale $\omega$ as a step-wise variable and derives a mathematically grounded formula to minimize inversion error at each step. Remarkably, POLARIS improves inversion latent quality with just one line of code. With negligible performance overhead, it substantially mitigates noise approximation errors and consistently improves the accuracy of downstream tasks.</p>
                </section> -->

                <div class="teaser-video-grid">
                    <div class="teaser-video-item">
                        <video class="teaser-sync-video" autoplay muted playsinline>
                            <source src="videos/tease1.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    <div class="teaser-video-item">
                        <video class="teaser-sync-video" autoplay muted playsinline>
                            <source src="videos/tease2.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </div>
                
                <p>The Inversion-Denoising Paradigm, which is based on diffusion models, excels in diverse image editing and restoration tasks.
                    We revisit its mechanism and reveal a critical, overlooked factor in reconstruction degradation: </b>the approximate noise error</b>
           . This error stems from approximating the noise at step $t$ with the prediction at step $t\!-\!1$, resulting in severe error accumulation throughout the inversion process. We introduce Projection-Orthogonal Least Squares for Robust and Adaptive Inversion (POLARIS), which reformulates inversion from an error-compensation problem into an error-origin problem. Rather than optimizing embeddings or latent codes to offset accumulated drift, POLARIS treats the guidance scale $\omega$ as a step-wise variable and derives a mathematically grounded formula to minimize inversion error at each step. Remarkably, POLARIS improves inversion latent quality with just one line of code. With negligible performance overhead, it substantially mitigates noise approximation errors and consistently improves the accuracy of downstream tasks.</p>
                
                <!-- <section id="Dataset" class="data section">
                    <h2>VANS-Data-100K Dataset</h2>
                    <div class="teaser-image-container" style="text-align: center; ">
                        <img src="images/data.png" alt="AnimeShooter Teaser" class="teaser-image" style="transform: scale(1.2); display: inline-block;">
                    </div>
                    <p>
                        The Inversion-Denoising Paradigm, which is based on diffusion models, excels in diverse image editing and restoration tasks.
                        We revisit its mechanism and reveal a critical, overlooked factor in reconstruction degradation:
                        <strong>the approximate noise error</strong>.
                        This error stems from approximating the noise at step $t$ with the prediction at step $t\!-\!1$, resulting in severe error accumulation throughout the inversion process.
                        We introduce Projection-Orthogonal Least Squares for Robust and Adaptive Inversion (POLARIS), which reformulates inversion from an error-compensation problem into an error-origin problem.
                        Rather than optimizing embeddings or latent codes to offset accumulated drift, POLARIS treats the guidance scale $\omega$ as a step-wise variable and derives a mathematically grounded formula to minimize inversion error at each step.
                        Remarkably, POLARIS improves inversion latent quality with just one line of code.
                        With negligible performance overhead, it substantially mitigates noise approximation errors and consistently improves the accuracy of downstream tasks.
                      </p>
                </section> -->

                <section id="method" class="method section">
                    <h2>POLARIS Method</h2>

                    <div class="method-content">
                        <div class="method-full">
                            <video class="method-video-full" controls autoplay muted playsinline data-loop="false">
                                <source src="videos/Method.mp4" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                            <p class="figure-caption"> (A) Existing CFG-based DDIM methods introduce and accumulate errors at each step of the inversion process, eventually leading
                                to the distribution shift of downstream tasks. (B) Our method actively seeks a mathematically invertible path to obtain a latent variable that
                                is closer to the ideal one. During generation, the recorded ωt sequence is replayed, enabling high-fidelity reconstruction. (C) Shows our
                                optimization goal from a geometric point of view to minimize the inversion error.</p>
                                <!-- </div> -->
                          </div>
                    </div>
                            
                            <!-- <div class="method-figure-wrapper">
                                <div class="method-figure">
                                    <img src="images/grpo.png" alt="Joint-GRPO Comparison" class="method-image grpo-image">
                                    <p class="figure-caption">Joint-GRPO: Two-stage co-steering optimization that bridges the semantic-to-visual gap between VLM and VDM.</p>
                                </div>
                            </div> -->
                        </div>
                
                        <!-- 文字描述部分 -->
                        <div class="method-description">
                            <div class="method-challenge">
                                <h3>Position of our work</h3>
                                <p>
                                    POLARIS reframes inversion from an error-compensation problem to an error-origin problem.
                                    Instead of optimizing embeddings or latents to counteract drift, we treat the guidance scale as a step-wise variable and derive a mathematically grounded rule that minimizes inversion error at each step.
                                    Concretely, we obtain a closed-form, per-timestep scale from an orthogonality condition between conditional/unconditional noise-change vectors, yielding a robust, plug-and-play dynamic schedule that can be dropped into standard DDIM inversion.
                                    POLARIS is thus complementary to prior pipelines: it preserves their modularity while replacing a brittle, fixed hyperparameter with an adaptive, theoretically justified control law.
                                </p>

                            </div>
                            
                            <!-- <div class="method-solution">
                                <h3>Joint-GRPO: Bridging the Semantic-Visual Gap</h3>
                                <p>
                                    Joint-GRPO coordinates the VLM and VDM using a joint reward function through structured two-stage optimization, 
                                    enabling effective co-steering while avoiding the attribution problems of one-stage joint training.
                                </p>
                                
                                <div class="method-highlights">
                                    <div class="highlight-item">
                                        <h4>Stage 1: Visualization-Friendly VLM Tuning</h4>
                                        <p>Optimizes the VLM policy while keeping VDM frozen. The joint reward combines format adherence, text fidelity (ROUGE-L), 
                                        and video fidelity (CLIP Similarity), guiding the VLM to generate captions that are not only semantically accurate but 
                                        also visually plausible and actionable for the VDM.</p>
                                    </div>
                                    
                                    <div class="highlight-item">
                                        <h4>Stage 2: Context-Faithful VDM Adaptation</h4>
                                        <p>Optimizes the VDM policy using the improved VLM as a frozen anchor. The reward function ensures visual coherence 
                                        with input context while enforcing strict semantic alignment with the VLM's caption through CLIPScore, preventing 
                                        the VDM from ignoring captions and merely reconstructing input videos.</p>
                                    </div>
                                </div>
                                <p>
                                    Through this two-stage optimization, the VLM and VDM co-evolve into a synergistic unit, effectively bridging the 
                                    semantic-to-visual gap and enabling high-quality Video-Next-Event Prediction.
                                </p>
                            </div> -->
                        </div>
                    </div>
                </section>
                

                
                <section id="editing" class="section">
                    <div class="section-title">
                        <h2>Qualitative Comparison on Editing Task</h2>
                        <p class="subtitle">Click on an example to watch the editing result</p>
                    </div>

                    <div class="question-grid editing-grid" id="editingButtons">
                        <div class="question-card editing-card" data-video="videos/editing/1.mp4">Example 1</div>
                        <div class="question-card editing-card" data-video="videos/editing/2.mp4">Example 2</div>
                        <div class="question-card editing-card" data-video="videos/editing/3.mp4">Example 3</div>
                        <div class="question-card editing-card" data-video="videos/editing/4.mp4">Example 4</div>
                        <div class="question-card editing-card" data-video="videos/editing/5.mp4">Example 5</div>
                        <div class="question-card editing-card" data-video="videos/editing/6.mp4">Example 6</div>
                        <div class="question-card editing-card" data-video="videos/editing/7.mp4">Example 7</div>
                        <div class="question-card editing-card" data-video="videos/editing/8.mp4">Example 8</div>
                    </div>

                    <div id="editingPlayer" class="expanded-question hidden fade-in"></div>
                </section>

                <section id="downstream-visualization" class="section">
                    <div class="section-title">
                        <h2>Visualization of Other Downstream Tasks</h2>
                    </div>

                    <div class="downstream-video-wrapper">
                        <video controls playsinline muted data-loop="false">
                            <source src="videos/other.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                </section>

                <section class="section" id="citation">
                    <div class="container is-max-desktop content">
                        <h2 class="title">Citation</h2>
                        <div class="citation-container">
                            <pre><code id="citation-code">None</code></pre>
                            <button class="copy-button" id="copy-btn" title="Copy to clipboard">
                                <svg class="copy-icon" viewBox="0 0 24 24">
                                    <path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
                                </svg>
                                <span class="copy-text">Copy</span>
                            </button>
                        </div>
                    </div>
                </section>
                
                <section id="acknowledgement" class="acknowledgement section">
                    <h2>Acknowledgement</h2>

                    
                    <div class="acknowledgement-content">
                        <p>
                            This work was supported by the Hong Kong University of Science and Technology (Guangzhou).
                        </p>
                        <p>
                            We sincerely appreciate Lei Wang and Yutao Yue for guiding the project, Haosen Li for his contributions to mathematical derivations, and Shaofeng Liang for the extensive effort in video production. Please feel free to reach out at <a href="mailto:chatoncws@gmail.com">chatoncws@gmail.com</a>.
                        </p>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <div class="video-modal" id="videoModal">
        <div class="modal-content">
            <button class="modal-close" id="modalClose">&times;</button>
            <div class="modal-method-name" id="modalMethodName"></div>
            <video class="modal-video" controls id="modalVideo">
                Your browser does not support the video tag.
            </video>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Polaris Project. All rights reserved.</p>
    </footer>

    <script>
    
        const copyButton = document.getElementById('copy-btn');
        const citationCode = document.getElementById('citation-code');

        copyButton.addEventListener('click', async () => {
            try {
                await navigator.clipboard.writeText(citationCode.textContent);
                
                // 显示成功状态
                copyButton.classList.add('copied');
                
                // 2秒后恢复原状
                setTimeout(() => {
                    copyButton.classList.remove('copied');
                }, 2000);
                
            } catch (err) {
                // 降级方案
                const textArea = document.createElement('textarea');
                textArea.value = citationCode.textContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                copyButton.classList.add('copied');
                setTimeout(() => {
                    copyButton.classList.remove('copied');
                }, 2000);
            }
        });



        // function initializeI2VGrid() {
        //     const grid = document.getElementById('i2vGrid');
            
        //     grid.innerHTML = '';
            
        //     i2vData.forEach((item, index) => {
        //         const card = document.createElement('div');
        //         card.className = 'i2v-card';
        //         card.innerHTML = `
        //             <p class="i2v-text">Case ${index + 1}</p>
        //         `;
        //         card.addEventListener('click', () => expandI2V(item, index));
        //         grid.appendChild(card);
        //     });
        // }

        // function expandI2V(item, index) {
        //     const allCards = document.querySelectorAll('#i2vGrid .i2v-card');
        //     allCards.forEach(card => card.classList.remove('active'));
            
        //     event.currentTarget.classList.add('active');
            
        //     const expandedView = document.getElementById('expandedI2VView');
            
        //     let answersHTML = '';
        //     item.answers.forEach((answer) => {
        //         const videoPath = `videos/${item.id}/${answer.file}`;
        //         answersHTML += `
        //             <div class="i2v-answer-card">
        //                 <div class="i2v-method-name">${answer.name}</div>
        //                 <div class="i2v-video-container" onclick="openVideoModal('${videoPath}', '${answer.name} - Case ${index + 1}')">
        //                     <video class="i2v-video" autoplay muted loop playsinline>
        //                         <source src="${videoPath}" type="video/mp4">
        //                         Your browser does not support the video tag.
        //                     </video>
        //                 </div>
        //             </div>
        //         `;
        //     });
            
        //     expandedView.innerHTML = `
        //         <div class="i2v-content">
        //             <div class="i2v-image-container" onclick="openImageModal('videos/${item.id}/input.png', 'Input Image - Case ${index + 1}')">
        //                 <img src="videos/${item.id}/input.png" alt="Input Image" class="i2v-image">
        //             </div>
        //             <div class="i2v-question">
        //                 <h4>Question</h4>
        //                 <p>${item.question}</p>
        //             </div>
        //         </div>
        //         <div class="i2v-answers-section">
        //             <h3>Generated Videos</h3>
        //             <div class="i2v-answers-grid">
        //                 ${answersHTML}
        //             </div>
        //         </div>
        //     `;
            
        //     expandedView.classList.remove('hidden');
        //     expandedView.classList.add('fade-in');
            
        //     const subtitle = document.querySelector('#image-to-video .section-title .subtitle');
        //     subtitle.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
        //     setupVideoControls();
        // }

        function openImageModal(imageSrc, title) {
            const imageModal = document.createElement('div');
            imageModal.className = 'video-modal active';
            imageModal.innerHTML = `
                <div class="modal-content">
                    <button class="modal-close" onclick="closeImageModal(this)">&times;</button>
                    <div class="modal-method-name">${title}</div>
                    <img src="${imageSrc}" alt="${title}" class="modal-image-square">
                </div>
            `;
            document.body.appendChild(imageModal);
            document.body.style.overflow = 'hidden';
        }

        function closeImageModal(closeBtn) {
            const imageModal = closeBtn.closest('.video-modal');
            imageModal.remove();
            document.body.style.overflow = '';
        }

        document.addEventListener('DOMContentLoaded', function() {
            initializeQuestionGrid('procedural');
            initializeQuestionGrid('predictive');
            initializeGeneralizationGrid();
            initializeI2VGrid();
            setupModalEvents();
        });

        function initializeGeneralizationGrid() {
            const grid = document.getElementById('generalizationGrid');
            
            grid.innerHTML = '';
            
            generalizationData.forEach((item, index) => {
                const card = document.createElement('div');
                card.className = 'generalization-card';
                card.innerHTML = `
                    <p class="generalization-text">Case ${index + 1}</p>
                `;
                card.addEventListener('click', () => expandGeneralization(item, index));
                grid.appendChild(card);
            });
        }

        function expandGeneralization(item, index) {
            const allCards = document.querySelectorAll('#generalizationGrid .generalization-card');
            allCards.forEach(card => card.classList.remove('active'));
            
            event.currentTarget.classList.add('active');
            
            const expandedView = document.getElementById('expandedGeneralizationView');
            
            let questionsHTML = '';
            item.questions.forEach((question, qIndex) => {
                questionsHTML += `
                    <div class="question-item">
                        <h4>Question ${qIndex + 1}</h4>
                        <p>${question}</p>
                    </div>
                `;
            });
            
            let answersHTML = '';
            item.answers.forEach((answer, aIndex) => {
                const videoPath = `videos/${item.id}/${answer}`;
                answersHTML += `
                    <div class="generalization-answer-card">
                        <div class="generalization-method-name">Response ${aIndex + 1}</div>
                        <div class="answer-video-container video-fix" onclick="openVideoModal('${videoPath}', 'Response ${aIndex + 1} - Scenario ${index + 1}')">
                            <video class="answer-video" autoplay muted loop playsinline>
                                <source src="${videoPath}" type="video/mp4">
                                Your browser does not support the video tag.
                            </video>
                        </div>
                    </div>
                `;
            });
            
            expandedView.innerHTML = `
                <div class="generalization-content">
                    <div class="generalization-input video-fix" onclick="openVideoModal('videos/${item.id}/input.mp4', 'Input Video - Scenario ${index + 1}')">
                        <video autoplay muted loop playsinline>
                            <source src="videos/${item.id}/input.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                    <div class="generalization-questions">
                        ${questionsHTML}
                    </div>
                </div>
                <div class="generalization-answers-section">
                    <h3>Model Responses</h3>
                    <div class="generalization-answers-grid">
                        ${answersHTML}
                    </div>
                </div>
            `;
            
            expandedView.classList.remove('hidden');
            expandedView.classList.add('fade-in');
            
            const subtitle = document.querySelector('#generalization .section-title .subtitle');
            subtitle.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            setupVideoControls();
        }

        document.addEventListener('DOMContentLoaded', function() {
            initializeQuestionGrid('procedural');
            initializeQuestionGrid('predictive');
            initializeGeneralizationGrid();
            setupModalEvents();
        });

        document.addEventListener('DOMContentLoaded', setupEditingSection);

        const videoModal = document.getElementById('videoModal');
        const modalVideo = document.getElementById('modalVideo');
        const modalClose = document.getElementById('modalClose');
        const modalMethodName = document.getElementById('modalMethodName');

        document.addEventListener('DOMContentLoaded', function() {
            initializeQuestionGrid('procedural');
            initializeQuestionGrid('predictive');
            setupModalEvents();
        });

        function setupModalEvents() {
            modalClose.addEventListener('click', closeVideoModal);
            
            videoModal.addEventListener('click', function(e) {
                if (e.target === videoModal) {
                    closeVideoModal();
                }
            });
            
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && videoModal.classList.contains('active')) {
                    closeVideoModal();
                }
            });
        }

        function openVideoModal(videoSrc, methodName) {
            modalVideo.src = videoSrc;
            modalMethodName.textContent = methodName;
            videoModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            modalVideo.play().catch(e => {
                console.log('Autoplay prevented:', e);
            });
        }

        function closeVideoModal() {
            videoModal.classList.remove('active');
            document.body.style.overflow = '';
            modalVideo.pause();
            modalVideo.src = '';
        }

        function setupEditingSection() {
            const buttons = document.querySelectorAll('.editing-card');
            const player = document.getElementById('editingPlayer');

            if (!buttons.length || !player) {
                return;
            }

            const showVideo = (src) => {
                player.innerHTML = `
                    <div class="expanded-video video-fix">
                        <video autoplay muted playsinline controls data-loop="false">
                            <source src="${src}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                `;
                player.classList.remove('hidden');
                setupVideoControls();
            };

            buttons.forEach(button => {
                button.addEventListener('click', () => {
                    buttons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    const videoSrc = button.dataset.video;
                    if (videoSrc) {
                        showVideo(videoSrc);
                    }
                });
            });

            const firstButton = buttons[0];
            if (firstButton) {
                buttons.forEach(btn => btn.classList.remove('active'));
                firstButton.classList.add('active');
                const initialSrc = firstButton.dataset.video;
                if (initialSrc) {
                    showVideo(initialSrc);
                }
            }
        }

        function initializeQuestionGrid(type) {
            const grid = document.getElementById(`${type}Questions`);
            const questions = questionData[type];
            
            grid.innerHTML = '';
            
            questions.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.innerHTML = `
                    <p class="question-text">Question ${index + 1}</p>
                `;
                card.addEventListener('click', () => expandQuestion(type, q, index));
                grid.appendChild(card);
            });
        }

        function expandQuestion(type, question, questionIndex) {
            const allCards = document.querySelectorAll(`#${type}Questions .question-card`);
            allCards.forEach(card => card.classList.remove('active'));
            
            event.currentTarget.classList.add('active');
            
            const expandedView = document.getElementById(`expanded${type.charAt(0).toUpperCase() + type.slice(1)}View`);
            
            expandedView.innerHTML = `
                <div class="expanded-video video-fix" onclick="openVideoModal('videos/${question.id}/input.mp4', 'Input Video - Question ${questionIndex + 1}')">
                    <video autoplay muted loop playsinline>
                        <source src="videos/${question.id}/input.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                </div>
            `;
                    
            expandedView.classList.remove('hidden');
            expandedView.classList.add('fade-in');

            const subtitle = document.querySelector(`#${type} .section-title .subtitle`);
            if (subtitle) {
                subtitle.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }

            setupVideoControls();
        }

        function setupTeaserSync() {
            const grids = document.querySelectorAll('.teaser-video-grid');
            grids.forEach(grid => {
                if (grid.dataset.syncAttached === 'true') {
                    return;
                }

                const videos = Array.from(grid.querySelectorAll('video.teaser-sync-video'));
                if (videos.length < 2) {
                    grid.dataset.syncAttached = 'true';
                    return;
                }

                const endedSet = new Set();

                const restartGroup = () => {
                    endedSet.clear();
                    videos.forEach(video => {
                        video.pause();
                        video.currentTime = 0;
                        const playPromise = video.play();
                        if (playPromise !== undefined) {
                            playPromise.catch(() => {});
                        }
                    });
                };

                videos.forEach((video, index) => {
                    video.loop = false;
                    video.addEventListener('ended', () => {
                        endedSet.add(index);
                        if (endedSet.size === videos.length) {
                            setTimeout(restartGroup, 150);
                        } else {
                            video.pause();
                        }
                    });
                });

                grid.dataset.syncAttached = 'true';
            });
        }

        function setupVideoControls() {
            const videos = document.querySelectorAll('video');
            videos.forEach(video => {
                const isTeaserSyncVideo = video.classList.contains('teaser-sync-video');
                const datasetLoop = video.dataset.loop;
                
                video.autoplay = true;
                video.muted = true;
                video.playsInline = true;

                if (isTeaserSyncVideo) {
                    video.loop = false;
                } else if (datasetLoop !== undefined) {
                    video.loop = datasetLoop === 'true';
                } else {
                    video.loop = true;
                }
                
                video.addEventListener('play', function() {
                    if (this.parentElement.classList.contains('expanded-video')) {
                        videos.forEach(otherVideo => {
                            if (otherVideo !== this && otherVideo.parentElement.classList.contains('expanded-video')) {
                                otherVideo.pause();
                            }
                        });
                    }
                });
            });

            setupTeaserSync();
        }

        const sections = document.querySelectorAll('.section');
        const options = {
            root: null,
            threshold: 0.1,
            rootMargin: "0px"
        };

        const observer = new IntersectionObserver(function(entries, observer) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    observer.unobserve(entry.target);
                }
            });
        }, options);

        sections.forEach(section => {
            observer.observe(section);
        });
    </script>
</body>

</html>







